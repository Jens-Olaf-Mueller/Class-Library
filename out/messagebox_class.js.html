<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: messagebox_class.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: messagebox_class.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Library from './library_class.js'

const OVERLAY_ID = 'msg-BoxOverlay',
      Z_INDEX_TOP = 2147483647,
      BTN_ID = 'msg-btn-';

class MessageBox extends Library{
    #prompt;
    get prompt() { return this.#prompt };
    set prompt(text) {
        this.#prompt = (text == null) ? '' : text;
    }
    #title;
    get title() { return this.#title };
    set title(text) {         
        if (text == null || text.trim() == '') {
            this.#title = document.getElementsByTagName('title')[0].innerText;
        } else {
            this.#title = text;
        }
    }
    modal = true;       // box is per default ALWAYS modal!
    gradient = true;
    #gradientFrom ='000A6D';
    get gradientColorFrom() { return this.#gradientFrom; } 
    set gradientColorFrom(value) { 
        this.#gradientFrom = value;
        this.#setCSSVar('msg-gradient-color-from', value);
    }
    #gradientTo = 'whitesmoke';
    get gradientColorTo() { return this.#gradientTo; }
    set gradientColorTo(value) {
        this.#gradientTo = value;
        this.#setCSSVar('msg-gradient-color-to', value);
    }
    #backGround = 'whitesmoke';
    get backGroundColor() { return this.#backGround; }
    set backGroundColor(value) {
        this.#backGround = value;
        this.#setCSSVar('msg-background-color', value);
    }

    #btnColor ='buttonface';
    get buttonColor() { return this.#btnColor; } 
    set buttonColor(value) {
        this.#btnColor = value;
        this.#setCSSVar('msg-button-color', value);
    }

    #borderRadius = 8;
    get borderRadius() { return this.#borderRadius; } 
    set borderRadius(value) {
        if (value.substr(-2) != 'px') debugger
        this.#borderRadius = value;
        this.#setCSSVar('msg-border-radius', value);        
    }
    titleColor = 'whitesmoke';
    textColor = 'black';
    

    get cssClassOverlay() {
        return this.modal ? 'msg-overlay msg-modal' : 'msg-overlay';
    }
    #overlayBG = '#00000040';
    get overlayBackground() { return this.modal ? this.#overlayBG : 'transparent'; }
    set overlayBackground(color) { this.#overlayBG = color; }


    #arrButtons = ['Ok'];
    get buttons() { return this.#arrButtons; }
    /**
     * Assigns or returns the submitted buttons.
     * @param {string | string[]} buttons [Optional] String, separetd by comma or string array.
     * If omitted a default button is set to 'Ok'
     */
    set buttons(buttons) {        
        if (buttons == null) {
            this. #arrButtons = ['Ok'];
        } else if (buttons instanceof Array) {
            this.#arrButtons = buttons;
        } else {
            if (buttons.trim().length == 0) buttons = 'Ok';
            // eliminate white spaces!
            this.#arrButtons = buttons.split(',').map(btn => btn.trim());               
        }
    }


    /**
     * Creates a new instance of the MessageBox.
     * @param {string} styleSheet [Optional] the path to the stylesheet in order to style the messagebox as favoured.
     */
    constructor(styleSheet) {
        super(styleSheet);
    }

    /**
     * The main method of the class. Creates and displays a messagebox according to the settings
     * and the passed parameters. The calling function must be marked with the key word AWAIT. 
     * @param {string} prompt [Optional] The displayd message to the user. If no message is passed,
     * a non-modal default box with a single "OK" button will be displayed.
     * @param {string} title [Optional] The Caption of the message box. If omitted, the page title is used.
     * @param {string | string[]} buttons [Optional] String, separeted by comma or string array.
     * If omitted, a single "OK" button is displayed.
     * @param {boolean} modal [Optional] Tells wether the messagebox is displayed modal (default) or not
     * @param {boolean} gradient [Optional] Tells wether the title bar has got a color gradient (default) or not.
     * @returns A promise. The promise is solved to the clicked button text, which serves as the answer.
     */
    async show(prompt, title, buttons, modal, gradient) {
        this.#setParams(prompt, title, buttons, modal, gradient);
        this.#createOverlay();
        this.#renderBox();
        const modular = this.modal;
        // now we create a promise with an event listener
        return new Promise(function(resolve, reject) {
            document.body.addEventListener('click', function btnHandler(event) {
                const clickedOn = event.target.id;
                if (clickedOn.startsWith(BTN_ID)) {                
                    resolve(document.getElementById(clickedOn).innerText);
                    document.body.removeEventListener('click', btnHandler);
                    document.getElementById(OVERLAY_ID).remove();
                } else if (event.target.id == OVERLAY_ID &amp;&amp; !modular) {                
                    resolve('false');
                    document.body.removeEventListener('click', btnHandler);
                    document.getElementById(OVERLAY_ID).remove();
                }       
            });        
        });
    }

    
    /**
     * PRIVATE helper function.
     * 
     * Generates the actual box according to the class properties.
     */
    #renderBox() {
        // titlebar with gradient ?
        let dlgClass = this.gradient ? 'msg-titlebar msg-gradient' : 'msg-titlebar';
        // set a white caption when gradient exists!
        let captionStyle = this.gradient ? `style="color: whitesmoke !important"` : '';
        document.getElementById(OVERLAY_ID).innerHTML = `
        &lt;div class="msg-dialog">
            &lt;div class ="${dlgClass}">
                &lt;h2 id="msgCaption" ${captionStyle}>${this.title}&lt;/h2>
            &lt;/div>
            &lt;p class="msg-Prompt">${this.prompt}&lt;/p>
            ${this.#renderButtons()}
        &lt;/div>`;
    }

    /**
     * PRIVATE helper function.
     * 
     * Renders the required buttons for the messagebox.
     * @returns {HTMLButtonElement} HTML code of the buttons.
     */
    #renderButtons() {
        let btnCode = '';            
        for (let i = 0; i &lt; this.buttons.length; i++) {
            btnCode += `&lt;button id="${BTN_ID}${i}" class="msg-button">${this.buttons[i]}&lt;/button>`;
        }
        return btnCode;
    }


    /**
     * PRIVATE helper function.
     * 
     * Parses the passed parameters of the {@link show} method.
     */
    #setParams(prompt, title, buttons, modal, gradient) { 
        this.prompt = prompt;
        this.title = title;
        this.buttons = buttons;
        this.modal = (modal == null) ? true : modal;
        if (typeof gradient == 'boolean') this.gradient = gradient;
    }


    /**
     * PRIVATE helper function that creates the dialog wrapper.
     */
    #createOverlay() {
        const parentBox = document.createElement('div');
        this.setAttributes(parentBox, {
            id: OVERLAY_ID,
            style: `z-index: ${Z_INDEX_TOP} !important; 
                    background-color: ${this.overlayBackground};
                    position: fixed;
                    inset: 0;
                    display: flex;
                    justify-content: center;
                    align-items: center;`,
            class: this.cssClassOverlay});
        document.body.appendChild(parentBox);
    }


    // Set the value of css variables to another value
    #setCSSVar(varName, value) {
        document.querySelector(':root').style.setProperty(`--${varName}`, value);
    }
}

export default MessageBox;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="-_js_collection_class.module_js.html">js</a></li></ul><h3>Classes</h3><ul><li><a href="-_js_collection_class.module_js-Collection.html">Collection</a></li><li><a href="Column.html">Column</a></li><li><a href="Library.html">Library</a></li><li><a href="MessageBox.html">MessageBox</a></li><li><a href="Table.html">Table</a></li><li><a href="Timer.html">Timer</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Tue Mar 28 2023 23:03:40 GMT+0200 (Mitteleurop√§ische Sommerzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
